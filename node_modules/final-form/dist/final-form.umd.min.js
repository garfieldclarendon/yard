!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e["final-form"]={})}(this,function(e){"use strict";var t=function(e){if(null===e||void 0===e)return[];if("string"!=typeof e)throw new Error("toPath() expects a string");return e.length?e.split(/[.[\]]+/).filter(Boolean):[]},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},a=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},o=function(e,i){var n=t(i),a=e,o=!0,u=!1,s=void 0;try{for(var l,c=n[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value;if(void 0===a||null===a||"object"!==(void 0===a?"undefined":r(a))||Array.isArray(a)&&isNaN(f))return;a=a[f]}}catch(e){u=!0,s=e}finally{try{!o&&c.return&&c.return()}finally{if(u)throw s}}return a},u=function(e,r,o){if(void 0===e||null===e)throw new Error("Cannot call setIn() with "+String(e)+" state");if(void 0===r||null===r)throw new Error("Cannot call setIn() with "+String(r)+" key");return function e(t,r,o,u){if(r>=o.length)return u;var s=o[r];if(isNaN(s)){if(void 0===t||null===t){var l=e(void 0,r+1,o,u);return void 0===l?void 0:i({},s,l)}if(Array.isArray(t))throw new Error("Cannot set a non-numeric property on an array");var c=e(t[s],r+1,o,u),f=Object.keys(t).length;if(void 0===c){if(void 0===t[s]&&0===f)return;if(void 0!==t[s]&&f<=1)return isNaN(o[r-1])?void 0:{}}return n({},t,i({},s,c))}var d=Number(s);if(void 0===t||null===t){var v=e(void 0,r+1,o,u);if(void 0===v)return;var b=[];return b[d]=v,b}if(!Array.isArray(t))throw new Error("Cannot set a numeric property on an object");var m=e(t[d],r+1,o,u),S=[].concat(a(t));return S[d]=m,S}(e,0,t(r),o)},s=function(e,t){var r=e.errors,i=e.initialValues,n=e.lastSubmittedValues,a=e.submitErrors,u=e.submitFailed,s=e.submitSucceeded,l=e.values,c=t.active,f=t.blur,d=t.change,v=t.data,b=t.focus,m=t.name,S=t.touched,h=t.visited,y=o(l,m),g=o(r,m),p=a&&o(a,m),E=i&&o(i,m),O=t.isEqual(E,y),j=!(!n||t.isEqual(o(n,m),y)),F=!g&&!p;return{active:c,blur:f,change:d,data:v,dirty:!O,dirtySinceLastSubmit:j,error:g,focus:b,initial:E,invalid:!F,length:Array.isArray(y)?y.length:void 0,name:m,pristine:O,submitError:p,submitFailed:u,submitSucceeded:s,touched:S,valid:F,value:y,visited:h}},l=["active","data","dirty","dirtySinceLastSubmit","error","initial","invalid","length","pristine","submitError","submitFailed","submitSucceeded","touched","valid","value","visited"],c=function(e,t){if(e===t)return!0;if("object"!==(void 0===e?"undefined":r(e))||!e||"object"!==(void 0===t?"undefined":r(t))||!t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),o=0;o<i.length;o++){var u=i[o];if(!a(u)||e[u]!==t[u])return!1}return!0};function f(e,t,r,i,n,a){var o=!1;return n.forEach(function(n){i[n]&&(e[n]=t[n],r&&(~a.indexOf(n)?c(t[n],r[n]):t[n]===r[n])||(o=!0))}),o}var d=["data"],v=function(e,t,r,i){var n={blur:e.blur,change:e.change,focus:e.focus,name:e.name};return f(n,e,t,r,l,d)||!t||i?n:void 0},b=["active","dirty","dirtySinceLastSubmit","error","errors","initialValues","invalid","pristine","submitting","submitError","submitErrors","submitFailed","submitSucceeded","touched","valid","validating","values","visited"],m=["touched","visited"],S=function(e,t,r,i){var n={};return f(n,e,t,r,b,m)||!t||i?n:void 0},h=function(e){var t=void 0,r=void 0;return function(){for(var i=arguments.length,n=Array(i),a=0;a<i;a++)n[a]=arguments[a];return t&&n.length===t.length&&!n.some(function(e,r){return!c(t[r],e)})||(t=n,r=e.apply(void 0,n)),r}},y=function(e){return!!e&&("object"===(void 0===e?"undefined":r(e))||"function"==typeof e)&&"function"==typeof e.then},g=Symbol("form-error"),p=function(e,t){return e===t},E=function(e){var t=e.active,r=e.dirtySinceLastSubmit,i=e.error,n=e.errors,a=e.initialValues,o=e.pristine,u=e.submitting,s=e.submitFailed,l=e.submitSucceeded,c=e.submitError,f=e.submitErrors,d=e.valid;return{active:t,dirty:!o,dirtySinceLastSubmit:r,error:i,errors:n,invalid:!d,initialValues:a,pristine:o,submitting:u,submitFailed:s,submitSucceeded:l,submitError:c,submitErrors:f,valid:d,validating:e.validating>0,values:e.values}};function O(e,t,r,i,n){var a=n(r,i,t,arguments.length>5&&void 0!==arguments[5]&&arguments[5]);a&&e(a)}function j(e,t,r,i){var n=e.entries;Object.keys(n).forEach(function(e){var a=n[Number(e)],o=a.subscription;O(a.subscriber,o,t,r,i)})}e.createForm=function(e){if(!e)throw new Error("No config specified");e.debug;var t=e.initialValues,r=e.mutators,i=e.onSubmit,l=e.validate,f=e.validateOnBlur;if(!i)throw new Error("No onSubmit function specified");var d={subscribers:{index:0,entries:{}},fieldSubscribers:{},fields:{},formState:{dirtySinceLastSubmit:!1,errors:{},initialValues:t&&n({},t),invalid:!1,pristine:!0,submitting:!1,submitFailed:!1,submitSucceeded:!1,valid:!0,validating:0,values:t?n({},t):{}},lastFormState:void 0},b=!1,m=!1,F=!1,w=0,V={},k=function(e){return function(t){return delete V[e],t}},A=function(e,t,r){if(e.fields[t]){var i=r(o(e.formState.values,t));e.formState.values=u(e.formState.values,t,i)||{}}},N=r&&Object.keys(r).reduce(function(e,t){return e[t]=function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];var a={formState:d.formState,fields:d.fields},s=r[t](i,a,{changeValue:A,getIn:o,setIn:u,shallowEqual:c});return d.formState=a.formState,d.fields=a.fields,P(void 0,function(){I(),L()}),s},e},{})||{},x=function(e){return Object.keys(e.validators).reduce(function(t,r){var i=e.validators[Number(r)]();return i&&t.push(i),t},[])},P=function(e,t){if(m)return F=!0,void(t&&t());var r=d.fields,i=d.formState,s=Object.keys(r);if(l||s.some(function(e){return x(r[e]).length})){if(e){var f=r[e].validateFields;f&&(s=f.length?f.concat(e):[e])}var v={},b={},S=[].concat(a(function(e){var t=[];if(l){var r=l(n({},d.formState.values));if(y(r)){var i=w++,a=r.then(e).then(k(i));t.push(a),V[i]=a}else e(r)}return t}(function(e){v=e||{}})),a(s.reduce(function(e,t){return e.concat(function(e,t){var r=[],i=x(e);if(i.length){var n=void 0;i.forEach(function(i){var a=i(o(d.formState.values,e.name),d.formState.values);if(a&&y(a)){var u=w++,s=a.then(t).then(k(u));r.push(s),V[u]=s}else n||(n=a)}),t(n)}return r}(r[t],function(e){b[t]=e}))},[]))),h=function(){var e=n({},v);s.forEach(function(t){if(r[t]){var i=b[t]||o(v,t);i&&(e=u(e,t,i))}}),c(i.errors,e)||(i.errors=e),i.error=v[g]};h(),S.length?(d.formState.validating++,t&&t(),Promise.all(S).then(function(){d.formState.validating--,h(),t&&t()})):t&&t()}else t&&t()},I=function(e){if(!b){var t=d.fields,r=d.fieldSubscribers,i=d.formState;Object.keys(t).forEach(function(e){var n=t[e],a=s(i,n),o=n.lastFieldState;c(a,o)||(n.lastFieldState=a,j(r[e],a,o,v))})}},q=function(){var e=d.fields,t=d.formState,r=d.lastFormState,i=Object.keys(e);t.pristine=i.every(function(r){return e[r].isEqual(o(t.values,r),o(t.initialValues||{},r))}),t.dirtySinceLastSubmit=!(!t.lastSubmittedValues||i.every(function(r){return e[r].isEqual(o(t.values,r),o(t.lastSubmittedValues||{},r))})),t.valid=!(t.error||t.submitError||Object.keys(t.errors).length||t.submitErrors&&Object.keys(t.submitErrors).length);var n=E(t),a=i.reduce(function(t,r){return t.touched[r]=e[r].touched,t.visited[r]=e[r].visited,t},{touched:{},visited:{}}),u=a.touched,s=a.visited;return n.touched=r&&c(r.touched,u)?r.touched:u,n.visited=r&&c(r.visited,s)?r.visited:s,r&&c(r,n)?r:n},L=function(){if(!b){var e=d.lastFormState,t=q();t!==e&&(d.lastFormState=t,j(d.subscribers,t,e,S))}};P();var R={batch:function(e){b=!0,e(),b=!1,I(),L()},blur:function(e){var t=d.fields,r=d.formState,i=t[e];i&&(delete r.active,t[e]=n({},i,{active:!1,touched:!0}),f?P(e,function(){I(),L()}):(I(),L()))},change:function(e,t){var r=d.fields,i=d.formState;r[e]&&o(i.values,e)!==t&&(A(d,e,function(){return t}),f?(I(),L()):P(e,function(){I(),L()}))},focus:function(e){var t=d.fields[e];t&&!t.active&&(d.formState.active=e,t.active=!0,t.visited=!0,I(),L())},mutators:N,getRegisteredFields:function(){return Object.keys(d.fields)},getState:function(){return E(d.formState)},initialize:function(e){var t=d.fields,r=d.formState;r.initialValues=e,r.values=e,Object.keys(t).forEach(function(e){var r=t[e];r.touched=!1,r.visited=!1}),P(void 0,function(){I(),L()})},pauseValidation:function(){m=!0},registerField:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3];d.fieldSubscribers[e]||(d.fieldSubscribers[e]={index:0,entries:{}});var n=d.fieldSubscribers[e].index++;if(d.fieldSubscribers[e].entries[n]={subscriber:h(t),subscription:r},!d.fields[e]){var a=d.formState.initialValues?o(d.formState.initialValues,e):void 0;d.fields[e]={active:!1,blur:function(){return R.blur(e)},change:function(t){return R.change(e,t)},data:{},focus:function(){return R.focus(e)},initial:a,isEqual:i&&i.isEqual||p,lastFieldState:void 0,name:e,touched:!1,valid:!0,validateFields:i&&i.validateFields,validators:{},visited:!1}}i&&i.getValidator&&(d.fields[e].validators[n]=i.getValidator);var u=!1;return P(void 0,function(){var i;L(),u||(i=s(d.formState,d.fields[e]),O(t,r,i,void 0,v,!0),d.fields[e].lastFieldState=i,u=!0),I()}),function(){delete d.fields[e].validators[n],delete d.fieldSubscribers[e].entries[n],Object.keys(d.fieldSubscribers[e].entries).length||(delete d.fieldSubscribers[e],delete d.fields[e]),P(void 0,function(){I(),L()})}},reset:function(){d.formState.submitFailed=!1,d.formState.submitSucceeded=!1,delete d.formState.submitErrors,delete d.formState.lastSubmittedValues,R.initialize(d.formState.initialValues||{})},resumeValidation:function(){m=!1,F&&P(void 0,function(){I(),L()}),F=!1},submit:function(){var e=d.formState,t=d.fields;if(d.formState.error||Object.keys(d.formState.errors).length)return Object.keys(t).forEach(function(e){t[e].touched=!0}),d.formState.submitFailed=!0,L(),void I();var r=Object.keys(V);if(r.length)Promise.all(r.reduce(function(e,t){return e.push(V[Number(t)]),e},[])).then(function(){return R.submit()});else{var a=void 0,o=!1,u=function(t){e.submitting=!1,t&&(Object.keys(t).length||Object.getOwnPropertySymbols(t).length)?(e.submitFailed=!0,e.submitSucceeded=!1,e.submitErrors=t,e.submitError=t[g]):(delete e.submitErrors,delete e.submitError,e.submitFailed=!1,e.submitSucceeded=!0),L(),I(),o=!0,a&&a()};if(e.submitting=!0,e.submitFailed=!1,e.submitSucceeded=!1,e.lastSubmittedValues=n({},e.values),3===i.length){if(i(e.values,R,u),!o)return L(),new Promise(function(e){a=e})}else{var s=i(e.values,R);if(s&&y(s))return L(),s.then(u);u(s)}}},subscribe:function(e,t){if(!e)throw new Error("No callback given.");if(!t)throw new Error("No subscription provided. What values do you want to listen to?");var r=h(e),i=d.subscribers,n=d.lastFormState,a=i.index++;i.entries[a]={subscriber:r,subscription:t};var o=q();return o!==n&&(d.lastFormState=o),O(r,t,o,o,S,!0),function(){delete i.entries[a]}}};return R},e.FORM_ERROR=g,e.version="4.2.0",e.formSubscriptionItems=b,e.fieldSubscriptionItems=l,e.getIn=o,e.setIn=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=final-form.umd.min.js.map
